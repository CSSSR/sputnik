# Изображения и их оптимизация
**Статус:** черновик.


## Растр
С вырезанием растра проблем обычно не возникает.
Проблемы возникают в размерах файлов.
Основные 2 формата изображений: JPG и PNG.
В первом хранятся всякие фотографии или фоны.
В PNG - иконки, все что требует прозрачности.


## Оптимизация растровых изображений
Картинки следует ужимать в любом случае.
Для начала стоит использовать Save for Web в самом Adobe Photoshop.
Затем, для JPG используется JPEGMini: использовать можно [на сайте](http://www.jpegmini.com/main/shrink_photo)
или установить условнобесплатное приложение, бесплатная версия позволяет ужимать до 20 фотографий в день,
это как правило, вполне достатончно. Экономия может достигать 50-500%.
Для PNG есть сервис [TinyPNG](https://tinypng.com). Суть заключается в том, что глубина цвета с 24 бит меняется на 8 бит.
Т.е. получается всего 256 цветов, но для отдельных иконок этого более чем достаточно.
При этом экономия получается примерно вдвое-втрое.
Нет смысла ужимать отдельные иконки, которые пойдут в спрайт, но есть смысл ужимать спрайт целиком.
TinyPNG доступен в виде пакета для Grunt и Gulp, который ужимает все это в автоматическом режиме,
единственное ограничение — 500 картинок в месяц.


## Вектор в Adobe Illustartor
Вектор из AI – при наличии установленного AI проблем нет тоже.
Открывается Vector Smart Object в самом AI (контекстное меню слоя — Редактирвоать содержимое / Edit Contents)
и оттуда экспортируется в SVG. В случае отсутствия установленного иллюстратора можно из Photoshop
экспортировать его в отдельный AI файл (контекстное меню слоя – Экспорт содержимого / Export Contents)
и сконвертировать в SVG – https://cloudconvert.org/ai-to-svg.
Но тут проблема в том, что экспортируется файл целиком, поэтому всякие наборы иконок вырезать таким способом не получится.


## Вектор в формах Photoshop
Формы (shape) — это лучший вариант. Можно вырезать самим Photoshop,
если версия CC или CC2014 – http://creativedroplets.com/generate-svg-with-photoshop-cc-beta/.
Либо есть плагины (платные) — Zeick и SVG Hero. Все это хорошо, но в некоторых конвретных случаях все это может лагать
и вырезать SVG, внутри которого PNG в BASE64. Например, сам Photoshop не умеет экспортировать папки шейпов.
По размеру можно понять или просто проверить содержимое иконки. Такие «кривые» иконки мало того что не вектор,
весят больше чем обычный png, так еще и не отображаются на мобильниках и в сафари.


## Использование векторных иконок
Самый лучший вариант — строчный SVG, внедрённый в HTML-разметку.
Это несколько «захламляет» разметку, но зато позволяет делать очень крутые вещи.
Смена цвета иконок из стилей, SMIL-анимация.
По этому поводу можно посмотреть лекцию http://video.yandex.ru/users/ya-events/view/3228.
Тем более, SVG поддерживается всеми современными браузерами.
Проблема есть лишь в IE8 и Android 2.3.
Но это решаемо изящным костылем — навешивание фона на `<svg>` элемент.
А для конвертации SVG в PNG есть всякие Grunt-задачи.


## Минификация SVG
Для SVG есть прекрасный инструмент — [SVGO](https://github.com/svg/svgo).
Как показывает практика, после экспорта почти любая иконка ужимается вдвое, были случаи с уменьшением и на 90%.
Но с SVGO стоит быть аккуратным — некоторые особо сложные SVG он портит.
После экспорта из редакторов внутри SVG есть куча ненужного кода, но SVGO не знает, что именно лишнее.
Например, Sketch при экспорте SVG добавляет две лишних обертки `<g>`,
на многие мешает атрибуты из области видимости скетча (ну и сама область видимости).
Примерно так же поступает и Adobe Illustrator.
По-хорошему, всё лишнее убрать и затем пропустить через SVGO.
