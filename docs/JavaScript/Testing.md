# Тестирование

Основная цель тестов — убедиться, что конечный продукт или какая-то его часть работают корректно. Помимо этого есть и другая польза:

- Тесты выступают как документация. Если на какой-то случай есть тест,
  значит поведение точно должно быть таким.
  Например, если у функции деления при делении на ноль есть два варианта
  работы: бросить исключение или вернуть бесконечность. Если теста нет,
  то непонятно текущее поведение задумывалось или его просто забыли учесть.
- Тесты упрощают рефакторинг — на текущий функционал уже написаны тесты,
  а значит можно изменять внутреннюю реализацию, не боясь что-то сломать.
- Во многих случаях тесты ускоряют (а не замедляют!) написание кода.
  Причина в том, что во время написания кода нет необходимости
  вручную проверять все возможные кейсы работы, чтобы убедиться,
  что всё работает корректно.

## Unit-тесты

Unit-тесты - это тесты, которые тестируют какой-то
один изолированный модуль — например, функцию или класс.

Наиболее легкотестируемыми являются чистые функции — функции,
которые получают всё необходимое в своих аргументах и возвращают результат
каких-либо вычислений.

Основные преимущества в том, что такие функции не требуют для себя
какого-либо cпецифичного окружения — например, браузера.
А значит, что такие тесты проще запускать, и, так как внутри
только какие-либо вычисление, тест проходит быстро.

Сам юнит-тест представляет собой вызов функции и проверку на то,
что функция вернула какое-то определенное значение. Иными словами,
юнит-тест — это простое сравнение результата с каким-либо эталоном.

```javascript
it('corrects sum number', async () => {
  const expected = sum(2, 5);
  expect(expected).toEqual(7);
});
```

Проверок должно быть столько, сколько необходимо чтобы покрыть
все основные случаи работы.

Например, для функции сложения это будут варианты:
- сложение с нулем;
- сложение отрицательных чисел;
- сложение дробных чисел.
Например, нет смысла проверять несколько похожих вариантов: 2 и 4, 3 и 3.
Какие варианты стоит проверять зависит уже от самой функции.

## Code Coverage

Покрытие кода — это метрика, которая показывает какое количество
кода было протестировано.
Покрытие может вычисляется по-разному:
- покрытие операторов — каждая ли строчка выполнилась;
- покрытие условий — каждая ли ветка функции была выполнена;
- покрытие функций — каждая ли функция вызывалась.

100% покрытие кода не гарантирует того, что модуль работает корректно.
Для покрытия линейной функции достаточно одного теста — все операторы
выполняться в этом тесте. Но, если внутри есть деление на аргумент функции,
то потенциально возможно деление на ноль и тест не проверяет,
что деление на ноль корректно обрабатывает.

## TDD
TDD — техника разработки, в которой сначала пишутся тесты, а затем
функция. Тесты пишутся только на какую-то небольшую часть функционала.

В целом процесс разработки выглядит так:
1. написать тесты для какой-либо части функционала;
2. запустить тесты и убедиться, что тесты не проходят — необходимо убедиться,
  что тесты корректные (а не проходят всегда);
3. написать код для функционала, чтобы код проходил тесты, при этом
  код не должен быть идеален, он должен просто проходить тесты;
4. проверить, что проходят все тесты;
5. отрефакторить код;
6. вернуться к первому шагу.
